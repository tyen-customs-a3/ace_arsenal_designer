<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACE3 Arsenal Simulation</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/info-panel.css">
</head>
<body>
    
    <div class="arsenal-container">
        <!-- Compact Category Sidebar -->
        <div class="category-sidebar">
            <button class="category-tab active" data-category="weapons" data-tooltip="Primary Weapons">‚óà</button>
            <button class="category-tab" data-category="handguns" data-tooltip="Handguns">‚óê</button>
            <button class="category-tab" data-category="launchers" data-tooltip="Launchers">‚óé</button>
            <button class="category-tab" data-category="binoculars" data-tooltip="Binoculars & Designators">üîç</button>
            <button class="category-tab" data-category="backpacks" data-tooltip="Backpacks">‚ó¢</button>
            <button class="category-tab" data-category="vests" data-tooltip="Vests">‚óß</button>
        </div>

        <!-- Left Panel - Equipment List -->
        <div class="left-panel">
            <div class="left-panel-header">
                <input type="text" class="header-search full-width" id="leftSearch" placeholder="Search...">
            </div>
            
            
            <!-- Tree Controls outside and above list -->
            <div class="tree-controls-external">
                <button class="tree-toggle-btn" id="treeToggleBtn" onclick="toggleExpandCollapse()">+</button>
                <span class="tree-toggle-text" id="treeToggleText">Expand All</span>
                
                <!-- Sort controls in same row -->
                <div class="sort-control-group">
                    <label class="control-label">Sort by:</label>
                    <select id="sortingSelect">
                        <option value="sortByName">Name</option>
                        <option value="sortByMod">Mod</option>
                        <option value="sortByRange">Range</option>
                        <option value="sortByMass">Mass</option>
                    </select>
                    <button class="sort-order-toggle" id="sortOrderToggle" onclick="toggleSortOrder()" title="Toggle sort order">‚Üë</button>
                </div>
            </div>
            
            <div class="left-content">
                <ul class="tree-view" id="leftTreeView">
                    <!-- Category items will be populated here -->
                </ul>
            </div>
        </div>

        <!-- Vertical Panel Container -->
        <div class="side-panels-container">
            <!-- Compact Options Panel -->
            <div class="compact-options-panel expanded" id="compactOptionsPanel">
                <!-- Options toggle header -->
                <div class="filter-toggle-header" onclick="toggleOptionsPanel()">
                    <span class="filter-toggle-text">Options</span>
                    <span class="filter-toggle-arrow" id="optionsToggleArrow">‚ñº</span>
                </div>
                
                <!-- Options content -->
                <div class="filter-content" id="optionsContent" style="display: block;">
                    <!-- Group by Options -->
                    <div class="compact-filter-group">
                        <label class="compact-filter-label">Group by:</label>
                        <div class="compact-filter-radios">
                            <label class="compact-filter-option">
                                <input type="radio" name="groupByOption" value="none" onchange="updateGrouping('none')">
                                <span>None</span>
                            </label>
                            <label class="compact-filter-option">
                                <input type="radio" name="groupByOption" value="groupByMod" checked onchange="updateGrouping('groupByMod')">
                                <span>Mod</span>
                            </label>
                            <label class="compact-filter-option">
                                <input type="radio" name="groupByOption" value="groupByCaliber" onchange="updateGrouping('groupByCaliber')">
                                <span>Caliber</span>
                            </label>
                            <label class="compact-filter-option">
                                <input type="radio" name="groupByOption" value="groupByWeaponType" onchange="updateGrouping('groupByWeaponType')">
                                <span>Weapon Type</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- View Mode Options -->
                    <div class="compact-filter-group">
                        <label class="compact-filter-label">View:</label>
                        <div class="compact-filter-radios">
                            <label class="compact-filter-option">
                                <input type="radio" name="viewMode" value="list" onchange="setViewMode('list')">
                                <span>üìÑ List</span>
                            </label>
                            <label class="compact-filter-option">
                                <input type="radio" name="viewMode" value="hierarchy" checked onchange="setViewMode('hierarchy')">
                                <span>üå≥ Tree</span>
                            </label>
                            <label class="compact-filter-option">
                                <input type="radio" name="viewMode" value="variants" onchange="setViewMode('variants')">
                                <span>üé® Variants</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Icon Display Options -->
                    <div class="compact-filter-group">
                        <label class="compact-filter-label">Icons:</label>
                        <div class="compact-filter-checkboxes">
                            <label class="filter-checkbox">
                                <input type="checkbox" id="showPreviewIcon" onchange="togglePreviewIcon(this.checked)" checked>
                                <span>Preview Icon</span>
                            </label>
                            <label class="filter-checkbox">
                                <input type="checkbox" id="showModIcon" onchange="toggleModIcon(this.checked)" checked>
                                <span>Mod Icon</span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Row Spacing Options -->
                    <div class="compact-filter-group">
                        <label class="compact-filter-label">Spacing:</label>
                        <div class="compact-filter-radios">
                            <label class="compact-filter-option">
                                <input type="radio" name="spacingOption" value="compact" onchange="changeSpacing('compact')">
                                <span>Compact</span>
                            </label>
                            <label class="compact-filter-option">
                                <input type="radio" name="spacingOption" value="general" checked onchange="changeSpacing('general')">
                                <span>General</span>
                            </label>
                            <label class="compact-filter-option">
                                <input type="radio" name="spacingOption" value="spacious" onchange="changeSpacing('spacious')">
                                <span>Spacious</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>


            <!-- Compact Stats Panel -->
            <div class="compact-stats-panel expanded" id="compactStatsPanel">
                <!-- Stats toggle header -->
                <div class="filter-toggle-header" onclick="toggleStatsPanel()">
                    <span class="filter-toggle-text">Statistics</span>
                    <span class="filter-toggle-arrow" id="statsToggleArrow">‚ñº</span>
                </div>
                
                <!-- Stats content -->
                <div class="filter-content" id="statsContent" style="display: block;">
                    <div class="stat-item">
                        <span class="stat-label">Name:</span>
                        <span class="stat-value" id="statName">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Class Name:</span>
                        <span class="stat-value" id="statClassName">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Mod:</span>
                        <span class="stat-value" id="statMod">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Damage:</span>
                        <span class="stat-value" id="statDamage">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Range:</span>
                        <span class="stat-value" id="statRange">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Mass:</span>
                        <span class="stat-value" id="statMass">-</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Capacity:</span>
                        <span class="stat-value" id="statCapacity">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel - Selected Item Options -->
        <div class="right-panel">
            <div class="right-panel-header">
                <input type="text" class="header-search full-width" id="rightSearch" placeholder="Search...">
            </div>
            <div class="right-content">
                <ul class="tree-view" id="rightTreeView">
                    <!-- Attachments and magazines will be populated here -->
                </ul>
            </div>
        </div>

        <!-- Right Panel Filters -->
        <div class="right-panel-filter" id="rightPanelFilter">
            <!-- Filter toggle header -->
            <div class="filter-toggle-header" onclick="toggleRightPanelFilter()">
                <span class="filter-toggle-text">Filters</span>
                <span class="filter-toggle-arrow" id="rightFilterToggleArrow">‚ñ∂</span>
            </div>
            
            <!-- Filter content -->
            <div class="filter-content" id="rightFilterContent">
                <!-- Attachment/Magazine specific filters -->
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Magnification:</label>
                    <div class="compact-filter-checkboxes" id="magnificationFilters">
                        <!-- Populated dynamically for optics -->
                    </div>
                </div>
                
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Capacity:</label>
                    <div class="compact-filter-checkboxes" id="capacityFilters">
                        <!-- Populated dynamically for magazines -->
                    </div>
                </div>
                
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Tracer:</label>
                    <div class="compact-filter-checkboxes" id="tracerFilters">
                        <!-- Populated dynamically for magazines -->
                    </div>
                </div>
                
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Ballistics:</label>
                    <div class="compact-filter-checkboxes" id="ballisticsFilters">
                        <!-- Populated dynamically for magazines -->
                    </div>
                </div>
                
                <button class="clear-filters-btn" onclick="clearRightPanelFilters()" title="Clear all right panel filters">Clear All Filters</button>
            </div>
        </div>

        <!-- Attachment Category Sidebar -->
        <div class="attachment-sidebar" id="attachmentSidebar">
            <!-- All possible tabs - we'll show/hide as needed -->
            <button class="attachment-tab active" data-attachment="optics" data-tooltip="Optics" data-context="weapon">üî≠</button>
            <button class="attachment-tab" data-attachment="attachments" data-tooltip="Attachments" data-context="weapon">‚öô</button>
            <button class="attachment-tab" data-attachment="bipods" data-tooltip="Bipods" data-context="weapon">üîß</button>
            <button class="attachment-tab" data-attachment="magazines" data-tooltip="Magazines" data-context="both">‚óà</button>
            <button class="attachment-tab" data-attachment="medical" data-tooltip="Medical" data-context="storage" style="display: none;">üè•</button>
            <button class="attachment-tab" data-attachment="food" data-tooltip="Food" data-context="storage" style="display: none;">üçΩÔ∏è</button>
            <button class="attachment-tab" data-attachment="tools" data-tooltip="Tools" data-context="storage" style="display: none;">üîß</button>
            <button class="attachment-tab" data-attachment="misc" data-tooltip="Miscellaneous" data-context="storage" style="display: none;">üì¶</button>
        </div>


        <!-- Bottom Right Filters Panel -->
        <div class="bottom-right-filter-panel expanded" id="bottomRightFilterPanel">
            <!-- Filter toggle header -->
            <div class="filter-toggle-header" onclick="toggleFilterPanel()">
                <span class="filter-toggle-text">Filters</span>
                <span class="filter-toggle-arrow" id="filterToggleArrow">‚ñº</span>
            </div>
            
            <!-- Filter content -->
            <div class="filter-content" id="filterContent" style="display: block;">
                <!-- Compact Filter Groups -->
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Mod:</label>
                    <div class="compact-filter-checkboxes" id="modFilters">
                        <!-- Populated dynamically -->
                    </div>
                </div>
                
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Caliber:</label>
                    <div class="compact-filter-checkboxes" id="caliberFilters">
                        <!-- Populated dynamically -->
                    </div>
                </div>
                
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Weapon Type:</label>
                    <div class="compact-filter-checkboxes" id="weaponTypeFilters">
                        <!-- Populated dynamically -->
                    </div>
                </div>
                
                <div class="compact-filter-group">
                    <label class="compact-filter-label">Variants:</label>
                    <div class="compact-filter-checkboxes">
                        <label class="filter-checkbox">
                            <input type="checkbox" id="showBaseItems" onchange="toggleVariantFilter('base', this.checked)" checked>
                            <span>Base Items</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" id="showVariants" onchange="toggleVariantFilter('variants', this.checked)" checked>
                            <span>Variants</span>
                        </label>
                    </div>
                </div>
                
                <button class="clear-filters-btn" onclick="clearAllFilters()" title="Clear all filters">Clear All Filters</button>
            </div>
        </div>

        <div class="timing" id="timing">Ready</div>
        
        <!-- Bottom Button Row -->
        <div class="bottom-button-row">
            <button class="arsenal-bottom-btn arsenal-bottom-btn-wide">EXIT</button>
            <button class="arsenal-bottom-btn">HIDE</button>
            <button class="arsenal-bottom-btn">SAVE</button>
            <button class="arsenal-bottom-btn">LOAD</button>
            <button class="arsenal-bottom-btn">EXPORT</button>
            <button class="arsenal-bottom-btn">IMPORT</button>
            <button class="arsenal-bottom-btn arsenal-bottom-btn-wide">TRY</button>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>